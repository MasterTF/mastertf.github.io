<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/avatar.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/avatar.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="å®‰è£…macä¸Šå®‰è£…rabbitmqæ¯”è¾ƒç®€å•ï¼Œå‚è€ƒå®˜ç½‘æ•™ç¨‹ http://www.rabbitmq.com/install-standalone-mac.html å³å¯ã€‚é‡åˆ°äº†ä¸‹è½½å¾ˆæ…¢é—®é¢˜ï¼Œæ‰¾äº†å…¶ä»–ç½‘ç«™ä¸Šä¸‹ã€‚ å…¶ä»–ç³»ç»Ÿå®‰è£…æ–¹å¼åœ¨å®˜ç½‘ä¹Ÿæœ‰è¯¦ç»†æè¿°ï¼Œä¸å†ç´¯è¿°ã€‚">
<meta name="keywords" content="æ¶ˆæ¯é˜Ÿåˆ—,RabbitMQ">
<meta property="og:type" content="article">
<meta property="og:title" content="RabbitMQæ¦‚è¿°">
<meta property="og:url" content="http://yoursite.com/2017/02/05/RabbitMQæ¦‚è¿°/index.html">
<meta property="og:site_name" content="Stay Hungry">
<meta property="og:description" content="å®‰è£…macä¸Šå®‰è£…rabbitmqæ¯”è¾ƒç®€å•ï¼Œå‚è€ƒå®˜ç½‘æ•™ç¨‹ http://www.rabbitmq.com/install-standalone-mac.html å³å¯ã€‚é‡åˆ°äº†ä¸‹è½½å¾ˆæ…¢é—®é¢˜ï¼Œæ‰¾äº†å…¶ä»–ç½‘ç«™ä¸Šä¸‹ã€‚ å…¶ä»–ç³»ç»Ÿå®‰è£…æ–¹å¼åœ¨å®˜ç½‘ä¹Ÿæœ‰è¯¦ç»†æè¿°ï¼Œä¸å†ç´¯è¿°ã€‚">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/img/15255306886088.jpg">
<meta property="og:updated_time" content="2021-11-18T15:48:05.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RabbitMQæ¦‚è¿°">
<meta name="twitter:description" content="å®‰è£…macä¸Šå®‰è£…rabbitmqæ¯”è¾ƒç®€å•ï¼Œå‚è€ƒå®˜ç½‘æ•™ç¨‹ http://www.rabbitmq.com/install-standalone-mac.html å³å¯ã€‚é‡åˆ°äº†ä¸‹è½½å¾ˆæ…¢é—®é¢˜ï¼Œæ‰¾äº†å…¶ä»–ç½‘ç«™ä¸Šä¸‹ã€‚ å…¶ä»–ç³»ç»Ÿå®‰è£…æ–¹å¼åœ¨å®˜ç½‘ä¹Ÿæœ‰è¯¦ç»†æè¿°ï¼Œä¸å†ç´¯è¿°ã€‚">
<meta name="twitter:image" content="http://yoursite.com/img/15255306886088.jpg">

<link rel="canonical" href="http://yoursite.com/2017/02/05/RabbitMQæ¦‚è¿°/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>RabbitMQæ¦‚è¿° | Stay Hungry</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?dd92700263571bbe9d14e94c4c5fb0c4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Stay Hungry</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/iceCream.html" rel="section"><i class="fa fa-fw fa-heartbeat"></i>å…¬ç›Šç”œç­’ğŸ¦</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/05/RabbitMQæ¦‚è¿°/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/avatar.jpg">
      <meta itemprop="name" content="äºå¤§å¸…">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Stay Hungry">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RabbitMQæ¦‚è¿°
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-02-05 22:27:19" itemprop="dateCreated datePublished" datetime="2017-02-05T22:27:19+08:00">2017-02-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-11-18 23:48:05" itemprop="dateModified" datetime="2021-11-18T23:48:05+08:00">2021-11-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æŠ€æœ¯/" itemprop="url" rel="index"><span itemprop="name">æŠ€æœ¯</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>macä¸Šå®‰è£…rabbitmqæ¯”è¾ƒç®€å•ï¼Œå‚è€ƒå®˜ç½‘æ•™ç¨‹ <a href="http://www.rabbitmq.com/install-standalone-mac.html" target="_blank" rel="noopener">http://www.rabbitmq.com/install-standalone-mac.html</a> å³å¯ã€‚é‡åˆ°äº†ä¸‹è½½å¾ˆæ…¢é—®é¢˜ï¼Œæ‰¾äº†å…¶ä»–ç½‘ç«™ä¸Šä¸‹ã€‚</p>
<p>å…¶ä»–ç³»ç»Ÿå®‰è£…æ–¹å¼åœ¨å®˜ç½‘ä¹Ÿæœ‰è¯¦ç»†æè¿°ï¼Œä¸å†ç´¯è¿°ã€‚</p>
<a id="more"></a>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><ol>
<li>æŸ¥æ‰¾é»˜è®¤é…ç½®ä½ç½®ï¼šfind / -name â€œrabbitmq.config.exampleâ€ï¼Œæˆ‘è¿™è¾¹æœç´¢ç»“æœæ˜¯ï¼š/usr/share/doc/rabbitmq-server-3.6.1/rabbitmq.config.example</li>
<li>å¤åˆ¶é»˜è®¤é…ç½®ï¼šcp /usr/share/doc/rabbitmq-server-3.6.1/rabbitmq.config.example /etc/rabbitmq/</li>
<li>ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼šcd /etc/rabbitmq ; mv rabbitmq.config.example rabbitmq.config</li>
<li>å¼€å¯ Web ç•Œé¢ç®¡ç†ï¼šrabbitmq-plugins enable rabbitmq_management</li>
<li>é‡å¯ RabbitMQ æœåŠ¡ï¼šservice rabbitmq-server restart</li>
<li>å¼€æ”¾é˜²ç«å¢™ç«¯å£ï¼š<ul>
<li>sudo iptables -I INPUT -p tcp -m tcp â€“dport 15672 -j ACCEPT</li>
<li>sudo iptables -I INPUT -p tcp -m tcp â€“dport 5672 -j ACCEPT</li>
<li>sudo service iptables save</li>
<li>sudo service iptables restart</li>
</ul>
</li>
<li>æµè§ˆå™¨è®¿é—®ï¼š<a href="http://localhost:15672" target="_blank" rel="noopener">http://localhost:15672</a> é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼šguest é»˜è®¤ç®¡ç†å‘˜å¯†ç ï¼šguest</li>
</ol>
<p>å‚è€ƒ<a href="https://github.com/judasn/Linux-Tutorial/blob/master/RabbitMQ-Install-And-Settings.md" target="_blank" rel="noopener">https://github.com/judasn/Linux-Tutorial/blob/master/RabbitMQ-Install-And-Settings.md</a></p>
<h2 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h2><h3 id="Broker"><a href="#Broker" class="headerlink" title="Broker"></a>Broker</h3><p>ç®€å•æ¥è¯´å°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨</p>
<h3 id="Exchange"><a href="#Exchange" class="headerlink" title="Exchange"></a>Exchange</h3><p>æ¶ˆæ¯äº¤æ¢æœºï¼ŒæœåŠ¡å™¨ä¸­çš„å®ä½“ï¼Œç”¨æ¥æ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯å¹¶å°†è¿™äº›æ¶ˆæ¯è·¯ç”±ç»™æœåŠ¡å™¨ä¸­çš„é˜Ÿåˆ—</p>
<h3 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h3><p>æ¶ˆæ¯é˜Ÿåˆ—è½½ä½“ï¼Œç”¨æ¥ä¿å­˜æ¶ˆæ¯ç›´åˆ°å‘é€ç»™æ¶ˆè´¹è€…ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šè¢«æŠ•å…¥åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—</p>
<h3 id="Binding"><a href="#Binding" class="headerlink" title="Binding"></a>Binding</h3><p>ç»‘å®šå™¨ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯æŠŠexchangeå’ŒqueueæŒ‰ç…§è·¯ç”±è§„åˆ™ç»‘å®šèµ·æ¥</p>
<h3 id="Binding-Key"><a href="#Binding-Key" class="headerlink" title="Binding Key"></a>Binding Key</h3><p>ç»‘å®šå…³é”®å­—ï¼ŒExchangeè§†è‡ªèº«ç±»å‹æ¥å†³å®šBindingçš„è·¯ç”±è¡Œä¸º</p>
<h3 id="Routing-Key"><a href="#Routing-Key" class="headerlink" title="Routing Key"></a>Routing Key</h3><p>æ¶ˆæ¯çš„è·¯ç”±å…³é”®å­—ï¼ŒExchangeæ ¹æ®è¿™ä¸ªå…³é”®å­—å†³å®šå¦‚ä½•è·¯ç”±æŸæ¡æ¶ˆæ¯</p>
<h3 id="vhost"><a href="#vhost" class="headerlink" title="vhost"></a>vhost</h3><p>è™šæ‹Ÿä¸»æœºï¼Œä¸€æ‰¹äº¤æ¢å™¨ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œç›¸å…³å¯¹è±¡ï¼Œè™šæ‹Ÿä¸»æœºæ˜¯å…±äº«ç›¸åŒçš„èº«ä»½è®¤è¯å’ŒåŠ å¯†ç¯å¢ƒçš„ç‹¬ç«‹æœåŠ¡å™¨åŸŸï¼Œä¸€ä¸ªbrokeré‡Œå¯ä»¥å¼€è®¾å¤šä¸ªvhostï¼Œç”¨ä½œä¸åŒç”¨æˆ·çš„æƒé™åˆ†ç¦»</p>
<h3 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h3><p>å¤šè·¯å¤ç”¨è¿æ¥ä¸­çš„ä¸€æ¡ç‹¬ç«‹çš„åŒå‘æ•°æ®æµé€šé“ï¼Œä¸ºä¼šè¯æä¾›ç‰©ç†ä¼ è¾“ä»‹è´¨ï¼Œåœ¨å®¢æˆ·ç«¯çš„æ¯ä¸ªè¿æ¥é‡Œï¼Œå¯å»ºç«‹å¤šä¸ªchannel</p>
<h3 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h3><p>æ¶ˆè´¹è€…ï¼Œä¸€ä¸ªä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¯·æ±‚æ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åº</p>
<h3 id="Producer"><a href="#Producer" class="headerlink" title="Producer"></a>Producer</h3><p>ç”Ÿäº§è€…ï¼Œä¸€ä¸ªå‘äº¤æ¢å™¨å‘å¸ƒæ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åº</p>
<h2 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h2><p><img src="/img/15255306886088.jpg" alt></p>
<ol>
<li>æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘å¸ƒ(Public)åˆ° Exchange ä¸­.</li>
<li>Exchange æ ¹æ®é˜Ÿåˆ—çš„ç»‘å®šå…³ç³»å°†æ¶ˆæ¯åˆ†å‘åˆ°ä¸åŒçš„ Queue ä¸­.</li>
<li>AMQP broker æ ¹æ®è®¢é˜…è§„åˆ™å°†æ¶ˆæ¯å‘é€ç»™æ¶ˆè´¹è€… æˆ– æ¶ˆè´¹è€…è‡ªè¡Œæ ¹æ®éœ€è¦ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯.</li>
</ol>
<p>Messageæ˜¯å½“å‰æ¨¡å‹ä¸­æ‰€æ“çºµçš„åŸºæœ¬å•ä½ï¼Œå®ƒç”±Produceräº§ç”Ÿï¼Œç»è¿‡Brokerè¢«Consumeræ‰€æ¶ˆè´¹ã€‚å®ƒçš„åŸºæœ¬ç»“æ„æœ‰ä¸¤éƒ¨åˆ†: Headerå’ŒBodyã€‚Headeræ˜¯ç”±Produceræ·»åŠ ä¸Šçš„å„ç§å±æ€§çš„é›†åˆï¼Œè¿™äº›å±æ€§æœ‰æ§åˆ¶Messageæ˜¯å¦å¯è¢«ç¼“å­˜ï¼Œæ¥æ”¶çš„queueæ˜¯å“ªä¸ªï¼Œä¼˜å…ˆçº§æ˜¯å¤šå°‘ç­‰ã€‚Bodyæ˜¯çœŸæ­£éœ€è¦ä¼ é€çš„æ•°æ®ï¼Œå®ƒæ˜¯å¯¹Brokerä¸å¯è§çš„äºŒè¿›åˆ¶æ•°æ®æµï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸åº”è¯¥å—åˆ°å½±å“ã€‚</p>
<h2 id="Exchange-å’Œ-Exchange-ç±»å‹"><a href="#Exchange-å’Œ-Exchange-ç±»å‹" class="headerlink" title="Exchange å’Œ Exchange ç±»å‹"></a>Exchange å’Œ Exchange ç±»å‹</h2><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>é»˜è®¤é¢„å®šä¹‰çš„åå­—</th>
</tr>
</thead>
<tbody>
<tr>
<td>Direct Exchange</td>
<td>ç©ºå­—ç¬¦ä¸²å’Œ amq.direct</td>
</tr>
<tr>
<td>Fanout Exchange</td>
<td>amq.fanout</td>
</tr>
<tr>
<td>Topic Exchange</td>
<td>amq.topic</td>
</tr>
<tr>
<td>Headers Exchange</td>
<td>amq.match(åœ¨ RabbitMQ ä¸­, é¢å¤–æä¾›amq.headers)</td>
</tr>
</tbody>
</table>
<h3 id="å…³äºé»˜è®¤-Exchange"><a href="#å…³äºé»˜è®¤-Exchange" class="headerlink" title="å…³äºé»˜è®¤ Exchange"></a>å…³äºé»˜è®¤ Exchange</h3><p>é»˜è®¤çš„ exchange æ˜¯ä¸€ä¸ªç”± broker é¢„åˆ›å»ºçš„åŒ¿åçš„(å³åå­—æ˜¯ç©ºå­—ç¬¦ä¸²) direct exchagne. å¯¹äºç®€å•çš„ç¨‹åºæ¥è¯´, é»˜è®¤çš„ exchange æœ‰ä¸€ä¸ªå®ç”¨çš„å±æ€§: å¦‚æœæ²¡æœ‰æ˜¾ç¤ºåœ°ç»‘å®š Exchnge, é‚£ä¹ˆåˆ›å»ºçš„æ¯ä¸ª queue éƒ½ä¼šè‡ªåŠ¨ç»‘å®šåˆ°è¿™ä¸ªé»˜è®¤çš„ exchagne ä¸­, å¹¶ä¸”æ­¤æ—¶è¿™ä¸ª queue çš„ route key å°±æ˜¯è¿™ä¸ªqueue çš„åå­—.</p>
<p>ä¾‹å¦‚å½“æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªåä¸º â€œsearch-indexing-onlineâ€ çš„ queue, é‚£ä¹ˆ AMQP broker ä¼šä»¥ â€œsearch-indexing-onlineâ€ ä½œä¸º route key å°†æ­¤ queue ç»‘å®šåˆ°é»˜è®¤çš„ exchange ä¸­. å› æ­¤å½“ä¸€ä¸ªæ¶ˆæ¯ä»¥ route key ä¸º â€œsearch-indexing-onlineâ€ æŠ•é€’åˆ°é»˜è®¤çš„ exchange ä¸­æ—¶, æ­¤æ¶ˆæ¯å°±ä¼šè¢«è·¯ç”±åˆ°è¿™ä¸ª queue ä¸­å». æ¢å¥è¯è¯´, ç”±äºæœ‰é»˜è®¤çš„ exchagne çš„å­˜åœ¨, æˆ‘ä»¬å°±å¥½åƒå¯ä»¥ç›´æ¥å°†æ¶ˆæ¯æŠ•é€’åˆ°æŒ‡å®šçš„ queue ä¸­å»è€Œä¸éœ€è¦ç»è¿‡ exchange ä¸€æ ·.</p>
<h2 id="RabbitMQåº”ç”¨åœºæ™¯"><a href="#RabbitMQåº”ç”¨åœºæ™¯" class="headerlink" title="RabbitMQåº”ç”¨åœºæ™¯"></a>RabbitMQåº”ç”¨åœºæ™¯</h2><p>å®˜ç½‘ä¸­æœ‰å¾ˆè¯¦ç»†çš„æ ·ä¾‹ï¼Œå„ä¸ªè¯­è¨€éƒ½æœ‰ï¼Œ<a href="http://www.rabbitmq.com/getstarted.html" target="_blank" rel="noopener">http://www.rabbitmq.com/getstarted.html</a> æ­¤å¤„ä¸å†è¯´æ˜ã€‚</p>
<h2 id="æŒä¹…åŒ–"><a href="#æŒä¹…åŒ–" class="headerlink" title="æŒä¹…åŒ–"></a>æŒä¹…åŒ–</h2><p>æœåŠ¡é‡å¯æ—¶, æ˜¯å¦èƒ½æ¢å¤é˜Ÿåˆ—ä¸­çš„æ•°æ®.</p>
<p>è€ƒè™‘è¿™æ ·çš„åœºæ™¯, å½“æ¶ˆæ¯è¢«æš‚å­˜åˆ°é˜Ÿåˆ—å, åœ¨æ²¡æœ‰è¢«æå–çš„æƒ…å†µä¸‹, RabbitMQ æœåŠ¡åœæ‰äº†æ€ä¹ˆåŠ.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'fanout'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'hello'</span>)</span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'hello'</span>)</span><br><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>, routing_key=<span class="string">''</span>, body=<span class="string">'Hello World!'</span>)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç , æˆ‘ä»¬åˆ›å»ºäº†ä¸€æ¡å†…å®¹ä¸º Hello World! çš„æ¶ˆæ¯, é€šè¿‡å‘½ä»¤è¡Œå·¥å…·:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span>  ./rabbitmqctl list_queues</span><br><span class="line">Listing queues ...</span><br><span class="line">hello    1</span><br><span class="line">...done.</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span> ./rabbitmqctl list_exchanges</span><br><span class="line">Listing exchanges ...</span><br><span class="line">    direct</span><br><span class="line">amq.direct    direct</span><br><span class="line">amq.fanout    fanout</span><br><span class="line">amq.headers    headers</span><br><span class="line">amq.match    headers</span><br><span class="line">amq.rabbitmq.log    topic</span><br><span class="line">amq.rabbitmq.trace    topic</span><br><span class="line">amq.topic    topic</span><br><span class="line">first    fanout</span><br><span class="line">...done.</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥æŸ¥åˆ°, åœ¨åä¸º hello çš„é˜Ÿåˆ—ä¸­, æœ‰ 1 æ¡æ¶ˆæ¯. æœ‰ä¸€ä¸ªç±»å‹ä¸º fanout , åä¸º first çš„äº¤æ¢å™¨.</p>
<p>æ­¤æ—¶é€šè¿‡ Ctrl-C æˆ– ./rabbitmqctl stop æŠŠ RabbitMQ æœåŠ¡åœæ‰, å†é‡å¯. äº¤æ¢å™¨, é˜Ÿåˆ—, æ¶ˆæ¯éƒ½æ˜¯ä¸ä¼šæ¢å¤çš„.</p>
<p>æ‰€ä»¥, é»˜è®¤æƒ…å†µä¸‹, <strong>æ¶ˆæ¯</strong>, <strong>é˜Ÿåˆ—</strong>, <strong>äº¤æ¢å™¨</strong> éƒ½ä¸å…·æœ‰æŒä¹…åŒ–çš„æ€§è´¨. å¦‚æœæˆ‘ä»¬éœ€è¦æŒä¹…åŒ–åŠŸèƒ½, é‚£ä¹ˆåœ¨å£°æ˜çš„æ—¶å€™å°±éœ€è¦é…ç½®å¥½.</p>
<p>äº¤æ¢å™¨å’Œé˜Ÿåˆ—çš„æŒä¹…åŒ–æ€§è´¨, åœ¨å£°æ˜æ—¶é€šè¿‡ä¸€ä¸ª durable å‚æ•°å³å¯å®ç°:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'fanout'</span>, durable=<span class="literal">True</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'hello'</span>, durable=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·, åœ¨æœåŠ¡é‡å¯ä¹‹å, first å’Œ hello éƒ½ä¼šæ¢å¤. ä½†æ˜¯ hello ä¸­çš„æ¶ˆæ¯ä¸ä¼š, è¿˜éœ€è¦é¢å¤–é…ç½®. è¿™æ˜¯ <strong>æ¶ˆæ¯</strong> çš„å±æ€§çš„ç›¸å…³å†…å®¹:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                      routing_key=<span class="string">''</span>,</span><br><span class="line">                      body=<span class="string">'Hello World!'</span>,</span><br><span class="line">                      properties=pika.BasicProperties(</span><br><span class="line">                         delivery_mode = <span class="number">2</span>,<span class="comment"># make message persistent</span></span><br><span class="line">                      ))</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ³¨æ„ä¸€ä¸‹, æ¶ˆæ¯çš„æŒä¹…åŒ–å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¼ºçš„çº¦æŸ, æ¶‰åŠæ•°æ®è½åœ°çš„æ—¶æœº, åŠç³»ç»Ÿå±‚é¢çš„ <strong>fsync</strong> ç­‰é—®é¢˜, ä¸è¦è®¤ä¸ºæ¶ˆæ¯å®Œå…¨ä¸ä¼šä¸¢. å¦‚æœè¦å°½å¯èƒ½é«˜åœ°æé«˜æ¶ˆæ¯çš„æŒä¹…åŒ–çš„æœ‰æ•ˆæ€§, è¿˜éœ€è¦é…ç½®å…¶å®ƒçš„ä¸€äº›æœºåˆ¶, æ¯”å¦‚åé¢ä¼šè°ˆåˆ°çš„ <strong>çŠ¶æ€åé¦ˆ</strong> ä¸­çš„ <strong>confirm mode</strong>.</p>
<p><strong>äº¤æ¢å™¨ , é˜Ÿåˆ—, æ¶ˆæ¯</strong> è¿™ä¸‰è€…çš„æŒä¹…åŒ–é—®é¢˜éƒ½ä»‹ç»è¿‡äº†. å‰ä¸¤è€…æ˜¯ä¸€ç»å£°æ˜, åˆ™å…¶æ€§è´¨æ— æ³•å†è¢«æ›´æ”¹, å³ä½ ä¸èƒ½å…ˆå£°æ˜ä¸€ä¸ªéæŒä¹…åŒ–çš„é˜Ÿåˆ—, å†å£°æ˜ä¸€ä¸ªæŒä¹…åŒ–çš„åŒåé˜Ÿåˆ—, ä¼å›¾ä¿®æ”¹å®ƒ, è¿™æ˜¯ä¸è¡Œçš„. ä½ é‡å¤å£°æ˜æ—¶, ç›¸å…³å‚æ•°éœ€è¦ä¸€è‡´. å½“ç„¶, ä½ å¯ä»¥åˆ é™¤å®ƒä»¬å†é‡æ–°å£°æ˜:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">channel.queue_delete(queue=<span class="string">'hello'</span>)</span><br><span class="line">channel.exchange_delete(exchange=<span class="string">'first'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="è°ƒåº¦ç­–ç•¥"><a href="#è°ƒåº¦ç­–ç•¥" class="headerlink" title="è°ƒåº¦ç­–ç•¥"></a>è°ƒåº¦ç­–ç•¥</h2><p>äº¤æ¢å™¨å¦‚ä½•æŠŠæ¶ˆæ¯ç»™åˆ°å“ªäº›é˜Ÿåˆ—, æ˜¯æ¯ä¸ªé˜Ÿåˆ—ç»™ä¸€æ¡, æˆ–è€…æŠŠä¸€æ¡æ¶ˆæ¯ç»™å¤šä¸ªé˜Ÿåˆ—.</p>
<p>æˆ‘ä»¬è€ƒè™‘äº¤æ¢å™¨ Exchange å’Œé˜Ÿåˆ— Queue çš„å…³ç³». Exchange åœ¨å¾—åˆ°æ¶ˆæ¯åä¼šä¾æ®è§„åˆ™æŠŠæ¶ˆæ¯æŠ•åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—å½“ä¸­.</p>
<p>åœ¨è°ƒåº¦ç­–ç•¥æ–¹é¢, æœ‰ä¸¤ä¸ªéœ€è¦äº†è§£çš„åœ°æ–¹, ä¸€æ˜¯äº¤æ¢å™¨çš„ç±»å‹(å‰é¢æˆ‘ä»¬ç”¨çš„æ˜¯ fanout), äºŒæ˜¯äº¤æ¢å™¨å’Œé˜Ÿåˆ—çš„ç»‘å®šå…³ç³». åœ¨ç»‘å®šäº†çš„å‰æä¸‹, æˆ‘ä»¬å†è°ˆä¸åŒç±»å‹çš„äº¤æ¢å™¨çš„è§„åˆ™. ç»‘å®šåŠ¨ä½œæœ¬èº«ä¹Ÿä¼šå½±å“äº¤æ¢å™¨çš„è¡Œä¸º.</p>
<p>äº¤æ¢å™¨çš„ç±»å‹, å†…ç½®çš„æœ‰å››ç§, åˆ†åˆ«æ˜¯:</p>
<ul>
<li>fanout</li>
<li>direct</li>
<li>topic</li>
<li>headers</li>
</ul>
<p>ä¸‹é¢ä¸€ä¸€ä»‹ç».</p>
<h3 id="fanout"><a href="#fanout" class="headerlink" title="fanout"></a>fanout</h3><p>æ•…åæ€ä¹‰, fanout ç±»å‹çš„äº¤æ¢å™¨, å…¶è¡Œä¸ºæ˜¯æŠŠæ¶ˆæ¯è½¬å‘ç»™æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—ä¸Š, å°±æ˜¯ä¸€ä¸ªâ€å¹¿æ’­â€è¡Œä¸º.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">import pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(&apos;localhost&apos;))</span><br><span class="line">channel = connection.channel()</span><br><span class="line"></span><br><span class="line">channel.exchange_declare(exchange=&apos;first&apos;, type=&apos;fanout&apos;)</span><br><span class="line">channel.queue_declare(queue=&apos;A&apos;)</span><br><span class="line">channel.queue_declare(queue=&apos;B&apos;)</span><br><span class="line">channel.queue_declare(queue=&apos;C&apos;)</span><br><span class="line"></span><br><span class="line">channel.queue_bind(exchange=&apos;first&apos;, queue=&apos;A&apos;)</span><br><span class="line">channel.queue_bind(exchange=&apos;first&apos;, queue=&apos;B&apos;)</span><br><span class="line"></span><br><span class="line">channel.basic_publish(exchange=&apos;first&apos;,</span><br><span class="line">                      routing_key=&apos;&apos;,</span><br><span class="line">                      body=&apos;Hello World!&apos;)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œ N æ¬¡, é€šè¿‡ rabbitmqctl å¯ä»¥çœ‹åˆ° A å’Œ B ä¸­å°±æœ‰ N æ¡æ¶ˆæ¯, è€Œ C ä¸­æ²¡æœ‰æ¶ˆæ¯. å› ä¸ºåªæœ‰ A å’Œ B æ˜¯ç»‘å®šåˆ°äº† first ä¸Šçš„.</p>
<h3 id="direct"><a href="#direct" class="headerlink" title="direct"></a>direct</h3><p>direct ç±»å‹çš„è¡Œä¸ºæ˜¯â€å…ˆåŒ¹é…, å†æŠ•é€â€. å³åœ¨ç»‘å®šæ—¶è®¾å®šä¸€ä¸ª routing_key , æ¶ˆæ¯çš„ routing_key åŒ¹é…æ—¶, æ‰ä¼šè¢«äº¤æ¢å™¨æŠ•é€åˆ°ç»‘å®šçš„é˜Ÿåˆ—ä¸­å»</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line"></span><br><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'direct'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'A'</span>, routing_key=<span class="string">'a'</span>)</span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'B'</span>, routing_key=<span class="string">'b'</span>)</span><br><span class="line"></span><br><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                      routing_key=<span class="string">'a'</span>,</span><br><span class="line">                      body=<span class="string">'Hello World!'</span>)</span><br></pre></td></tr></table></figure>
<p>A å’Œ B è™½ç„¶éƒ½ç»‘å®šåœ¨äº†ç±»å‹ä¸º direct çš„ first ä¸Š, ä½†æ˜¯ç»‘å®šæ—¶çš„ routing_key ä¸åŒ.</p>
<p>å½“ä¸€ä¸ª routing_key ä¸º a çš„æ¶ˆæ¯å‡ºæ¥æ—¶, åªä¼šè¢« first æŠ•é€åˆ° A é‡Œ.</p>
<h3 id="topic"><a href="#topic" class="headerlink" title="topic"></a>topic</h3><p>topic å’Œ direct ç±»ä¼¼, åªæ˜¯åŒ¹é…ä¸Šæ”¯æŒäº†â€æ¨¡å¼â€, åœ¨â€ç‚¹åˆ†â€çš„ routing_key å½¢å¼ä¸­, å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé€šé…ç¬¦:</p>
<ul>
<li>* è¡¨ç¤ºä¸€ä¸ªè¯.</li>
<li># è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªè¯.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line"></span><br><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'topic'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'A'</span>, routing_key=<span class="string">'a.*.*'</span>)</span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'B'</span>, routing_key=<span class="string">'a.#'</span>)</span><br><span class="line"></span><br><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                      routing_key=<span class="string">'a'</span>,</span><br><span class="line">                      body=<span class="string">'Hello World!'</span>)</span><br><span class="line"></span><br><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                      routing_key=<span class="string">'a.b.c'</span>,</span><br><span class="line">                      body=<span class="string">'Hello World!'</span>)</span><br></pre></td></tr></table></figure>
<p>åœ¨å‘å‡ºçš„ä¸¤æ¡æ¶ˆæ¯å½“ä¸­, a åªä¼šè¢« a.# åŒ¹é…åˆ°. è€Œ a.b.c ä¼šè¢«ä¸¤ä¸ªéƒ½åŒ¹é…åˆ°.</p>
<p>æ‰€ä»¥, æœ€ç»ˆçš„ç»“æœä¼šæ˜¯ A ä¸­æœ‰ä¸€æ¡æ¶ˆæ¯, B ä¸­æœ‰ä¸¤æ¡æ¶ˆæ¯.</p>
<h3 id="headers"><a href="#headers" class="headerlink" title="headers"></a>headers</h3><p>headers ä¹Ÿæ˜¯æ ¹æ®è§„åˆ™åŒ¹é…, ç›¸è¾ƒäº direct å’Œ topic å›ºå®šåœ°ä½¿ç”¨ routing_key , headers åˆ™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰åŒ¹é…è§„åˆ™çš„ç±»å‹.</p>
<p>åœ¨é˜Ÿåˆ—ä¸äº¤æ¢å™¨ç»‘å®šæ—¶, ä¼šè®¾å®šä¸€ç»„é”®å€¼å¯¹è§„åˆ™, æ¶ˆæ¯ä¸­ä¹ŸåŒ…æ‹¬ä¸€ç»„é”®å€¼å¯¹( headers å±æ€§), å½“è¿™äº›é”®å€¼å¯¹æœ‰ä¸€å¯¹, æˆ–å…¨éƒ¨åŒ¹é…æ—¶, æ¶ˆæ¯è¢«æŠ•é€åˆ°å¯¹åº”é˜Ÿåˆ—.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line"></span><br><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'headers'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'A'</span>, arguments=&#123;<span class="string">'a'</span>: <span class="string">'1'</span>&#125;)</span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'B'</span>, arguments=&#123;<span class="string">'b'</span>: <span class="string">'2'</span>, <span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'x-match'</span>: <span class="string">'all'</span>&#125;)</span><br><span class="line"></span><br><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                      routing_key=<span class="string">''</span>,</span><br><span class="line">                      properties=pika.BasicProperties(</span><br><span class="line">                          headers = &#123;<span class="string">'a'</span>: <span class="string">'2'</span>&#125;,</span><br><span class="line">                      ),</span><br><span class="line">                      body=<span class="string">'Hello World!'</span>)</span><br><span class="line"></span><br><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                      routing_key=<span class="string">''</span>,</span><br><span class="line">                      properties=pika.BasicProperties(</span><br><span class="line">                          headers = &#123;<span class="string">'a'</span>: <span class="string">'1'</span>, <span class="string">'b'</span>: <span class="string">'2'</span>&#125;,</span><br><span class="line">                      ),</span><br><span class="line">                      body=<span class="string">'Hello World!'</span>)</span><br></pre></td></tr></table></figure>
<p>ç»‘å®šæ—¶, é€šè¿‡ arguments å‚æ•°è®¾å®šåŒ¹é…è§„åˆ™, x-match æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è§„åˆ™, è¡¨ç¤ºéœ€è¦å…¨éƒ¨åŒ¹é…ä¸Š, è¿˜æ˜¯åªåŒ¹é…ä¸€æ¡:</p>
<ul>
<li>all , å…¨éƒ¨åŒ¹é….</li>
<li>any , åªåŒ¹é…ä¸€ä¸ª.</li>
</ul>
<p>æ¶ˆæ¯çš„ headers å±æ€§ä¼šç”¨äºè§„åˆ™çš„åŒ¹é….</p>
<p>ä¸Šé¢çš„ä»£ç ä¸­, ç¬¬ä¸€æ¡æ¶ˆæ¯ä¸ä¼šåŒ¹é…ä»»ä½•è§„åˆ™. ç¬¬äºŒæ¡æ¶ˆæ¯, åŒ¹é…åˆ° A , ä½†æ˜¯ä¸ä¼šåŒ¹é…åˆ° B (è™½ç„¶æœ‰ä¸€æ¡ b:2 ).</p>
<p>æœ€ç»ˆçš„ç»“æœæ˜¯, A ä¸­æœ‰ä¸€æ¡æ¶ˆæ¯, B ä¸­æ²¡æœ‰æ¶ˆæ¯.</p>
<h2 id="åˆ†é…ç­–ç•¥"><a href="#åˆ†é…ç­–ç•¥" class="headerlink" title="åˆ†é…ç­–ç•¥"></a>åˆ†é…ç­–ç•¥</h2><p>é˜Ÿåˆ—é¢å¯¹æ¶ˆè´¹è€…æ—¶, å¦‚ä½•æŠŠæ¶ˆæ¯åå‡ºå», æ¥ä¸€ä¸ªæ¶ˆè´¹è€…å°±æŠŠæ¶ˆæ¯å…¨ç»™å®ƒ, è¿˜æ˜¯åªç»™ä¸€æ¡.</p>
<p>è°ƒåº¦ç­–ç•¥æ˜¯å½±å“ Exchange æ˜¯ä¸æ˜¯è¦æŠŠæ¶ˆæ¯ç»™ Queue , è€Œåˆ†é…ç­–ç•¥å½±å“é˜Ÿåˆ—å¦‚ä½•æŠŠæ¶ˆæ¯ç»™ Consuming .</p>
<p>è€ƒè™‘è¿™æ ·çš„åœºæ™¯: é˜Ÿåˆ—ä¸­æœ‰å¤šæ¡æ¶ˆæ¯, æ¯ä¸€ä¸ªæ¶ˆè´¹è€…å–å‡ºæ¶ˆæ¯å, éƒ½è¦èŠ± 10 ç§’æ¥å¤„ç†å®ƒ, å¤„ç†å®Œä¸€æ¡æ¶ˆæ¯ä¹‹åæ‰å¯èƒ½å†å–å‡ºä¸€æ¡ç»§ç»­å¤„ç†. åˆšå¼€å§‹åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…, è¿‡äº† 2 ç§’åæ¥äº†ç¬¬äºŒä¸ªæ¶ˆè´¹è€…, æ­¤æ—¶, è¿™ä¸¤ä¸ªæ¶ˆè´¹è€…è·å–æ¶ˆæ¯çš„è¡Œä¸ºæ˜¯ä¸€ä¸ªä»€ä¹ˆçŠ¶æ€?</p>
<p>æˆ‘ä»¬çš„éœ€æ±‚å¯èƒ½æ˜¯, å½“ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ—¶, åªç»™å®ƒä¸€æ¡æ¶ˆæ¯, ç­‰å®ƒå†â€è¯·æ±‚â€æ—¶, å†ç»™. æˆ–è€…ä¹Ÿå¯èƒ½æ˜¯, å½“æœ‰æ¶ˆè´¹è€…æ—¶, å°±æŠŠç›®å‰æœ‰çš„æ¶ˆæ¯å…¨ç»™å®ƒ(å› ä¸ºä¸çŸ¥é“æ˜¯å¦è¿˜æœ‰å…¶å®ƒçš„æ¶ˆè´¹è€…, æ‰€ä»¥æ—¢ç„¶æ¥äº†ä¸€ä¸ªå°±è®©å®ƒå°½é‡å¤šå¤„ç†ä¸€äº›æ¶ˆæ¯).</p>
<p>å…ˆäº§ç”Ÿä¸€äº›ç­‰å¾…å¤„ç†çš„æ¶ˆæ¯:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line"></span><br><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'fanout'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line"></span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'A'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                          routing_key=<span class="string">''</span>,</span><br><span class="line">                          body=str(i))</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ˜¯æ¶ˆè´¹è€…çš„å®ç°:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span><span class="params">(ch, method, properties, body)</span>:</span></span><br><span class="line">    <span class="keyword">import</span> time</span><br><span class="line">    time.sleep(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">print</span> body</span><br><span class="line"></span><br><span class="line">channel.basic_consume(callback, queue=<span class="string">'A'</span>, no_ack=<span class="literal">True</span>)</span><br><span class="line">channel.start_consuming()</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç , æ˜¯å‡è®¾å¤„ç†ä¸€æ¡æ¶ˆæ¯éœ€è¦ 10 ç§’çš„æ—¶é—´. ä½†æ˜¯äº‹å®ä¸Š, ä½ åªè¦ä¸€æ‰§è¡Œä»£ç , é©¬ä¸Šå†ä½¿ç”¨ rabbitmqctl æŸ¥çœ‹é˜Ÿåˆ—çŠ¶æ€æ—¶, ä¼šå‘ç°é˜Ÿåˆ—å·²ç»ç©ºäº†. å› ä¸ºåœ¨å…³é—­ ack çš„æƒ…å†µä¸‹, Queue çš„è¡Œä¸ºæ˜¯, ä¸€æ—¦æœ‰æ¶ˆè´¹è€…è¯·æ±‚, é‚£ä¹ˆå½“å‰é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å®ƒéƒ½ä¼šä¸€æ¬¡æ€§åå¾ˆå¤šå‡ºå».</p>
<p>ack æœºåˆ¶åœ¨åé¢ çŠ¶æ€åé¦ˆ ä¼šä»‹ç»åˆ°, ç®€å•æ¥è¯´æ˜¯ä¸€ç§ç¡®è®¤æ¶ˆæ¯è¢«æ­£ç¡®å¤„ç†çš„æœºåˆ¶.</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³ä¸€æ¬¡åªåä¸€æ¡æ¶ˆæ¯, å½“å…¶å®ƒæ¶ˆè´¹è€…è¿ä¸Šæ¥æ—¶, è¿˜å¯ä»¥å¹¶è¡Œå¤„ç†, ç®€å•åœ°æŠŠ ack æ‰“å¼€å°±å¯ä»¥äº†(é»˜è®¤å°±æ˜¯æ‰“å¼€çš„).</p>
<p>å†è€ƒè™‘ä¸€ä¸‹ç»†èŠ‚. å½“æœ‰å¤šä¸ªæ¶ˆè´¹è€…è¿ä¸Šæ—¶, å®ƒæ˜¯ä»é˜Ÿåˆ—ä¸€æ¬¡å–ä¸€æ¡æ¶ˆæ¯, è¿˜æ˜¯ä¸€æ¬¡å–å¤šæ¡æ¶ˆæ¯(è¿™æ ·è‡³å°‘å¯ä»¥æ”¹å–„æ€§èƒ½). è¿™å¯ä»¥é€šè¿‡é…ç½® channel çš„ qos ç›¸å…³å‚æ•°å®ç°:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-importpika</span></span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line">channel.basic_qos(prefetch_count=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">defcallback(ch, method, properties, body):</span><br><span class="line">    importtime</span><br><span class="line">    time.sleep(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">print</span> body</span><br><span class="line">    ch.basic_ack(delivery_tag = method.delivery_tag)</span><br><span class="line"></span><br><span class="line">channel.basic_consume(callback, queue=<span class="string">'A'</span>, no_ack=<span class="literal">False</span>)</span><br><span class="line">channel.start_consuming()</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡é…ç½® prefetch_count å‚æ•°, æ¥è®¾ç½®ä¸€æ¬¡ä»é˜Ÿåˆ—ä¸­å–å¤šå°‘æ¡æ¶ˆæ¯. è¦çœ‹åˆ°æ•ˆæœ, è‡³å°‘éœ€è¦å¯ 2 ä¸ªæ¶ˆè´¹è€….</p>
<p>ä¹‹å‰æ˜¯ 10 ä¸ªæ•°å­—æŒ‰é¡ºåºå…¥äº†é˜Ÿåˆ—, channel çš„é…ç½®æ˜¯ä¸€æ¬¡å– 2 ä¸ª, é‚£ä¹ˆå¯ 2 ä¸ªæ¶ˆè´¹è€…çš„è¯, è¿‡ 10 ç§’, åœ¨ä¸¤ä¸ªæ¶ˆè´¹è€…çš„è¾“å‡ºä¸­åˆ†åˆ«èƒ½çœ‹åˆ° 0 , 2 . è¿™æ—¶æŠŠä¸¤ä¸ªæ¶ˆè´¹è€…éƒ½ Ctrl-C , é€šè¿‡ rabbitmqctl èƒ½çœ‹åˆ° A é˜Ÿåˆ—ä¸­è¿˜æœ‰ 8 æ¡æ¶ˆæ¯.</p>
<h2 id="çŠ¶æ€åé¦ˆ"><a href="#çŠ¶æ€åé¦ˆ" class="headerlink" title="çŠ¶æ€åé¦ˆ"></a>çŠ¶æ€åé¦ˆ</h2><p>å½“æ¶ˆæ¯ä»æŸä¸€ä¸ªé˜Ÿåˆ—ä¸­è¢«æå‡ºå, è¿™ä¸ªæ¶ˆæ¯çš„ç”Ÿå‘½å‘¨æœŸå°±æ­¤ç»“æŸ, è¿˜æ˜¯è¯´éœ€è¦ä¸€ä¸ªå…·ä½“çš„ä¿¡å·ä»¥æ˜ç¡®æ ‡è¯†æ¶ˆæ¯å·²è¢«æ­£ç¡®å¤„ç†.</p>
<p>çŠ¶æ€åé¦ˆ çš„åŠŸèƒ½ç›®çš„æ˜¯ä¸ºäº†ç¡®è®¤è¡Œä¸ºçš„ç»“æœ. æ¯”å¦‚, å½“ä½ å‘ Exchange æäº¤ä¸€ä¸ªæ¶ˆæ¯æ—¶, è¿™ä¸ªæ¶ˆæ¯æ˜¯å¦æäº¤æˆåŠŸ, æ˜¯å¦é€è¾¾åˆ°äº†é˜Ÿåˆ—ä¸­. å½“ä½ ä»é˜Ÿåˆ—ä¸­æå–æ¶ˆæ¯ä¹‹å, RabbitMQ çš„ Server å¦‚ä½•å¤„ç†, å› ä¸ºåœ¨æå–æ¶ˆæ¯ä¹‹å, Consuming å¯èƒ½åˆ¤æ–­æ¶ˆæ¯æœ‰é—®é¢˜, å¯èƒ½åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸.</p>
<p>åœ¨ä¸€äº›å…³é”®çš„èŠ‚ç‚¹ä¸Š, è¦ä¿è¯æ¶ˆæ¯çš„æ­£ç¡®å¤„ç†, å®‰å…¨å¤„ç†, æ˜¯éœ€è¦å¾ˆå¤šç»†èŠ‚ä¸Šçš„æ§åˆ¶çš„. AMQP åè®®æœ¬èº«ä¹Ÿä¸ºæ­¤ä½œäº†ç›¸å…³è®¾è®¡, ç”šè‡³æ˜¯äº‹åŠ¡æœºåˆ¶. äº‹å®ä¸Šåœ¨ AMQP ä¸­è¦ç¡®ä¿æ¶ˆæ¯çš„ä¸šåŠ¡å¯é æ€§åªèƒ½ä½¿ç”¨äº‹åŠ¡, ä¸è¿‡åœ¨ RabbitMQ ä¸­æœ‰ä¸€äº›ç›¸åº”çš„ç®€ä¾¿çš„æ‰©å±•æœºåˆ¶æ¥è¾¾åˆ°åŒæ ·ç›®çš„.</p>
<h3 id="ä¿¡æ¯å‘å¸ƒçš„ç¡®è®¤"><a href="#ä¿¡æ¯å‘å¸ƒçš„ç¡®è®¤" class="headerlink" title="ä¿¡æ¯å‘å¸ƒçš„ç¡®è®¤"></a>ä¿¡æ¯å‘å¸ƒçš„ç¡®è®¤</h3><p>å›çœ‹ä¸€ä¸‹ä¹‹å‰çš„ä¸€æ®µä»£ç :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">channel.basic_publish(exchange=<span class="string">'first'</span>, routing_key=<span class="string">''</span>, body=<span class="string">'Hello World!'</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç è¦åšçš„äº‹, æ˜¯æŠŠä¸€æ¡æ¶ˆæ¯å‘ç»™åä¸º first çš„äº¤æ¢å™¨. è¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°æ„å¤–:</p>
<ul>
<li>exchange çš„åå­—å†™é”™äº†.</li>
<li>exchange å¾—åˆ°æ¶ˆæ¯å, å‘ç°æ²¡æœ‰å¯¹åº”çš„ queue å¯ä»¥æŠ•é€.</li>
<li>æŠ•é€åˆ° queue åå½“å‰æ²¡æœ‰æ¶ˆè´¹è€…æ¥æå–å®ƒ.</li>
</ul>
<p>ä¸Šé¢çš„ä¸‰ç§æƒ…å†µ, ç¬¬ä¸€ç§, ä¼šç›´æ¥å¼•å‘ä¸€ä¸ªè°ƒç”¨é”™è¯¯. ç¬¬ä¸‰ç§, é€šå¸¸ä¸æ˜¯é—®é¢˜, åæ­£æ¶ˆæ¯ä¼šåœ¨ queue ä¸­æš‚å­˜. ä½†æ˜¯ç¬¬äºŒç§æƒ…å†µå¾ˆå¤šæ—¶å€™æ˜¯éœ€è¦é¿å…çš„, å¦åˆ™æ¶ˆæ¯å°±ä¸¢å¤±äº†, æ›´ä¸¥é‡çš„æ˜¯ Producing å¯¹æ­¤æµ‘ç„¶ä¸çŸ¥.</p>
<p>åœ¨è¿™ä¸ªåœ°æ–¹, æˆ‘ä»¬å°±éœ€è¦ç¡®è®¤æ¶ˆæ¯å‘å‡ºä¹‹å, æ˜¯å¦æˆåŠŸåœ°è¢«æŠ•é€åˆ° queue ä¸­å»äº†(æˆ–è€…çŸ¥é“å®ƒä¸èƒ½è¢«æŠ•é€åˆ°ä»»ä½• queue ä¸­å»).</p>
<p>è¦ç¡®è®¤è¿™äº›çŠ¶æ€ä¿¡æ¯, é¦–å…ˆéœ€è¦æŠŠ channel è®¾ç½®åˆ° confirm mode , ä¹Ÿç§°ä¹‹ä¸º Publisher Acknowledgements æœºåˆ¶ (å’Œæ¶ˆæ¯çš„ ack æœºåˆ¶åŒºåˆ†å¼€). å®ƒçš„ç›®çš„å°±æ˜¯ä¸ºäº†ç¡®è®¤ Producing å‘å‡ºçš„ä¿¡æ¯çš„çŠ¶æ€.</p>
<p>æ‰“å¼€ confirm mode çš„æ–¹æ³•æ˜¯:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">channel.confirm_delivery()</span><br></pre></td></tr></table></figure>
<p>ä¹‹åçš„ publish è¡Œä¸ºå°±å¯ä»¥æ”¶åˆ°æœåŠ¡å™¨çš„åé¦ˆ. æ¯”å¦‚åœ¨ basic_publish å‡½æ•°ä¸­, é€šè¿‡ mandatory=True å‚æ•°æ¥ç¡®è®¤å‘å‡ºçš„æ¶ˆæ¯æ˜¯å¦æœ‰ queue æ¥æ”¶, å¹¶ä¸”æ‰€æœ‰ queue éƒ½æˆåŠŸæ¥æ”¶.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line"></span><br><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'fanout'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#channel.queue_bind(exchange='first', queue='A')</span></span><br><span class="line"></span><br><span class="line">channel.confirm_delivery()</span><br><span class="line"></span><br><span class="line">r = channel.basic_publish(exchange=<span class="string">'first'</span>,</span><br><span class="line">                          routing_key=<span class="string">''</span>,</span><br><span class="line">                          body=<span class="string">'Hello'</span>,</span><br><span class="line">                          mandatory=<span class="literal">True</span>,</span><br><span class="line">                         )</span><br><span class="line"><span class="keyword">print</span> r</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä¸­, å› ä¸ºåä¸º first çš„ Exchange æ²¡æœ‰ç»‘å®šä»»ä½•çš„ queue , åœ¨ mandatory å‚æ•°çš„ä½œç”¨ä¸‹, basic_publish ä¼šè¿”å› False .</p>
<p>å¯¹äºæŒä¹…åŒ–æ€§è´¨, confirm mode çš„ç¡®è®¤ç»“æœæ˜¯è¡¨ç¤º, ä¸€æ¡ persisting çš„æ¶ˆæ¯, æŠ•é€ç»™ä¸€ä¸ª durable çš„é˜Ÿåˆ—æˆåŠŸ, å¹¶ä¸”æ•°æ®å·²ç»æˆåŠŸå†™åˆ°ç£ç›˜. å½“ç„¶, å› ä¸ºç³»ç»Ÿç¼“å­˜çš„é—®é¢˜, ä¸ºç¡®ä¿æ•°æ®æˆåŠŸè½åœ°, å¾—åˆ°ç¡®è®¤ä¿¡æ¯æœ‰æ—¶å¯èƒ½éœ€è¦é•¿è¾¾å‡ ç™¾æ¯«ç§’çš„æ—¶é—´, åº”ç”¨å¯¹æ­¤åº”è¯¥æœ‰æ‰€å‡†å¤‡, è€Œä¸è‡³äºåœ¨æ€§èƒ½ä¸Šå—æ­¤å½±å“.</p>
<h3 id="æ¶ˆæ¯æå–çš„ç¡®è®¤"><a href="#æ¶ˆæ¯æå–çš„ç¡®è®¤" class="headerlink" title="æ¶ˆæ¯æå–çš„ç¡®è®¤"></a>æ¶ˆæ¯æå–çš„ç¡®è®¤</h3><p>åœ¨æœªå…³é—­æ¶ˆæ¯çš„ ack æœºåˆ¶çš„æƒ…å†µä¸‹, å½“æ¶ˆæ¯è¢« Consuming ä»é˜Ÿåˆ—ä¸­æå–å, åœ¨æœªæ˜ç¡®è·å–ç¡®è®¤ä¿¡æ¯ä¹‹å‰, é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ˜¯ä¸ä¼šè¢«åˆ é™¤çš„. è¿™æ ·, æµç¨‹ä¸Šå°±å˜æˆ, å½“æ¶ˆæ¯è¢«æå–ä¹‹å, é˜Ÿåˆ—ä¸­çš„è¿™æ¡æ¶ˆæ¯å¤„äºâ€ç­‰å¾…ç¡®è®¤â€çš„çŠ¶æ€. å¦‚æœ Consuming åé¦ˆâ€æˆåŠŸâ€ç»™é˜Ÿåˆ—, åˆ™æ¶ˆæ¯å¯ä»¥å®‰å…¨åœ°è¢«åˆ é™¤äº†. å¦‚æœåé¦ˆâ€æ‹’ç»â€ç»™é˜Ÿåˆ—, åˆ™æ¶ˆæ¯å¯èƒ½è¿˜éœ€è¦å†æ¬¡è¢«å…¶å®ƒ Consuming æå–.</p>
<p>çœ‹ä¸‹é¢çš„ä¾‹å­, æˆ‘ä»¬å…ˆåˆ›å»ºé¡ºåºçš„ 10 ä¸ªæ•°å­—ä¸ºå†…å®¹çš„ 10 æ¡æ¶ˆæ¯:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line"></span><br><span class="line">channel.exchange_declare(exchange=<span class="string">'first'</span>, type=<span class="string">'fanout'</span>)</span><br><span class="line">channel.queue_declare(queue=<span class="string">'A'</span>)</span><br><span class="line"></span><br><span class="line">channel.queue_bind(exchange=<span class="string">'first'</span>, queue=<span class="string">'A'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    channel.basic_publish(exchange=<span class="string">'first'</span>, routing_key=<span class="string">''</span>, body=str(i))</span><br></pre></td></tr></table></figure>
<p>æå–æ¶ˆæ¯çš„é€»è¾‘:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line">r = channel.basic_get(queue=<span class="string">'A'</span>, no_ack=<span class="literal">False</span>) <span class="comment">#0</span></span><br><span class="line"><span class="keyword">print</span> r[<span class="number">-1</span>], r[<span class="number">0</span>].delivery_tag</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä¼šæå–ç¬¬ä¸€æ¡æ¶ˆæ¯, ä½†æ˜¯å¹¶æ²¡æœ‰å‘ Queue åé¦ˆæ­¤æ¶ˆæ¯æ˜¯å¦è¢«æ­£ç¡®å¤„ç†, æ‰€ä»¥è¿™æ¡æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­ä»ç„¶å­˜åœ¨, ç›´åˆ° Connection è¢«é‡Šæ”¾å, è¢«æå–è¿‡ä½†æ˜¯æœªè¢«ç¡®è®¤çš„æ¶ˆæ¯çš„çŠ¶æ€è¢«é‡ç½®, å®ƒå°±å¯ä»¥è¢«é‡æ–°æå–.</p>
<p>è¦ç¡®è®¤æ¶ˆæ¯, æˆ–è€…æ‹’ç»æ¶ˆæ¯, ä½¿ç”¨å¯¹åº”çš„ basic_ack å’Œ baskc_reject æ–¹æ³•:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line">r = channel.basic_get(queue=<span class="string">'A'</span>, no_ack=<span class="literal">False</span>) <span class="comment">#0</span></span><br><span class="line"><span class="keyword">print</span> r[<span class="number">-1</span>], r[<span class="number">0</span>].delivery_tag</span><br><span class="line"><span class="comment">#channel.basic_ack(delivery_tag=r[0].delivery_tag)</span></span><br><span class="line">channel.basic_reject(delivery_tag=r[<span class="number">0</span>].delivery_tag)</span><br></pre></td></tr></table></figure>
<p>AMQP åè®®ä¸­, åªæä¾›äº† reject æ–¹æ³•, å®ƒåªèƒ½å¤„ç†ä¸€æ¡æ¶ˆæ¯. å› ä¸º Consuming æ˜¯å¯ä»¥ä¸€æ¬¡æ€§æå–å¤šæ¡æ¶ˆæ¯çš„, æ‰€ä»¥ RabbitMQ ä¸ºæ­¤åšäº†æ‰©å±•, æä¾›äº† basic_nack æ–¹æ³•, å®ƒå’Œ basic_reject çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯æ”¯æŒä¸€æ¬¡æ€§æ‹’ç»å¤šæ¡æ¶ˆæ¯.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line">r = channel.basic_get(queue=<span class="string">'A'</span>, no_ack=<span class="literal">False</span>) <span class="comment">#0</span></span><br><span class="line">r = channel.basic_get(queue=<span class="string">'A'</span>, no_ack=<span class="literal">False</span>) <span class="comment">#1</span></span><br><span class="line">r = channel.basic_get(queue=<span class="string">'A'</span>, no_ack=<span class="literal">False</span>) <span class="comment">#2</span></span><br><span class="line">channel.basic_nack(delivery_tag=r[<span class="number">0</span>].delivery_tag, multiple=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>delivery_tag æ˜¯åœ¨ channel ä¸­çš„ä¸€ä¸ªæ¶ˆæ¯è®¡æ•°, æ¯æ¬¡æ¶ˆæ¯æå–è¡Œä¸ºéƒ½å¯¹åº”ä¸€ä¸ªæ•°å­—. nack çš„ multiple æœºåˆ¶ä¼šè‡ªåŠ¨æŠŠä¸å¤§äºæŒ‡å®š delivery_tag çš„æ¶ˆæ¯æå–éƒ½ reject æ‰.</p>
<p>åœ¨ reject å’Œ nack ä¸­è¿˜æœ‰ä¸€ä¸ª requeue å‚æ•°, è¡¨ç¤ºè¢«æ‹’ç»çš„æ¶ˆæ¯æ˜¯å¦å¯ä»¥è¢«é‡æ–°åˆ†é…. é»˜è®¤æ˜¯ True . å¦‚æœæ¶ˆæ¯è¢« reject ä¹‹å, ä¸å¸Œæœ›å†è¢«å…¶å®ƒçš„ Consuming å¾—åˆ°, å¯ä»¥æŠŠ requeue å‚æ•°è®¾ç½®æˆ False :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line">connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">'localhost'</span>))</span><br><span class="line">channel = connection.channel()</span><br><span class="line">r = channel.basic_get(queue=<span class="string">'A'</span>, no_ack=<span class="literal">False</span>) <span class="comment">#0</span></span><br><span class="line">channel.basic_nack(delivery_tag=r[<span class="number">0</span>].delivery_tag, multiple=<span class="literal">False</span>, requeue=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>basic_consume å’Œ basic_get éƒ½æ˜¯ä»æŒ‡å®š queue ä¸­æå–æ¶ˆæ¯, å‰è€…æ˜¯ä¸€ä¸ªæ›´é«˜å±‚çš„æ–¹æ³•, è¿˜æ”¯æŒ qos ç­‰.</p>

    </div>

    
    
    
        <div class="reward-container">
  <div>æ‰“é’±! æ‰“é’±! æ‰“é’±ğŸ˜¡ğŸ˜¡ğŸ˜¡</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    æ‰“èµ
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/img/wechat_pay.jpg" alt="äºå¤§å¸… å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/æ¶ˆæ¯é˜Ÿåˆ—/" rel="tag"><i class="fa fa-tag"></i> æ¶ˆæ¯é˜Ÿåˆ—</a>
              <a href="/tags/RabbitMQ/" rel="tag"><i class="fa fa-tag"></i> RabbitMQ</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2016/11/23/springäº‹åŠ¡ç®¡ç†/" rel="prev" title="springäº‹åŠ¡ç®¡ç†">
      <i class="fa fa-chevron-left"></i> springäº‹åŠ¡ç®¡ç†
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/03/29/ZSH-å®‰è£…/" rel="next" title="ZSH å®‰è£…">
      ZSH å®‰è£… <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å®‰è£…"><span class="nav-number">1.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é…ç½®"><span class="nav-number">2.</span> <span class="nav-text">é…ç½®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ ¸å¿ƒæ¦‚å¿µ"><span class="nav-number">3.</span> <span class="nav-text">æ ¸å¿ƒæ¦‚å¿µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Broker"><span class="nav-number">3.1.</span> <span class="nav-text">Broker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exchange"><span class="nav-number">3.2.</span> <span class="nav-text">Exchange</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Queue"><span class="nav-number">3.3.</span> <span class="nav-text">Queue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Binding"><span class="nav-number">3.4.</span> <span class="nav-text">Binding</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Binding-Key"><span class="nav-number">3.5.</span> <span class="nav-text">Binding Key</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Routing-Key"><span class="nav-number">3.6.</span> <span class="nav-text">Routing Key</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vhost"><span class="nav-number">3.7.</span> <span class="nav-text">vhost</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Channel"><span class="nav-number">3.8.</span> <span class="nav-text">Channel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Consumer"><span class="nav-number">3.9.</span> <span class="nav-text">Consumer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Producer"><span class="nav-number">3.10.</span> <span class="nav-text">Producer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å·¥ä½œæµç¨‹"><span class="nav-number">4.</span> <span class="nav-text">å·¥ä½œæµç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exchange-å’Œ-Exchange-ç±»å‹"><span class="nav-number">5.</span> <span class="nav-text">Exchange å’Œ Exchange ç±»å‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å…³äºé»˜è®¤-Exchange"><span class="nav-number">5.1.</span> <span class="nav-text">å…³äºé»˜è®¤ Exchange</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RabbitMQåº”ç”¨åœºæ™¯"><span class="nav-number">6.</span> <span class="nav-text">RabbitMQåº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æŒä¹…åŒ–"><span class="nav-number">7.</span> <span class="nav-text">æŒä¹…åŒ–</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è°ƒåº¦ç­–ç•¥"><span class="nav-number">8.</span> <span class="nav-text">è°ƒåº¦ç­–ç•¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#fanout"><span class="nav-number">8.1.</span> <span class="nav-text">fanout</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#direct"><span class="nav-number">8.2.</span> <span class="nav-text">direct</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#topic"><span class="nav-number">8.3.</span> <span class="nav-text">topic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#headers"><span class="nav-number">8.4.</span> <span class="nav-text">headers</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ†é…ç­–ç•¥"><span class="nav-number">9.</span> <span class="nav-text">åˆ†é…ç­–ç•¥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#çŠ¶æ€åé¦ˆ"><span class="nav-number">10.</span> <span class="nav-text">çŠ¶æ€åé¦ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¿¡æ¯å‘å¸ƒçš„ç¡®è®¤"><span class="nav-number">10.1.</span> <span class="nav-text">ä¿¡æ¯å‘å¸ƒçš„ç¡®è®¤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¶ˆæ¯æå–çš„ç¡®è®¤"><span class="nav-number">10.2.</span> <span class="nav-text">æ¶ˆæ¯æå–çš„ç¡®è®¤</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="äºå¤§å¸…"
      src="/img/avatar.jpg">
  <p class="site-author-name" itemprop="name">äºå¤§å¸…</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">48</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      æœ¬å¹¿å‘Šä½é•¿æœŸæ‹›ç§Ÿ
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://mastertf.github.io/" title="https://mastertf.github.io/" rel="noopener" target="_blank">å¹¿å‘Šé“¾æ¥</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">äºå¤§å¸…</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
